% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/z_generic_request.R
\name{generic_request}
\alias{generic_request}
\title{Generic API Request Function}
\usage{
generic_request(
  query,
  endpoint,
  method = "POST",
  server = "ctx_burl",
  batch_limit = NULL,
  auth = TRUE,
  tidy = TRUE,
  path_params = NULL,
  content_type = "application/json",
  ...
)
}
\arguments{
\item{query}{A character vector or list of items to be queried (e.g., DTXSIDs, CASRNs).
For static endpoints (batch_limit=0), pass NULL or a placeholder value.}

\item{endpoint}{The API endpoint path (e.g., "hazard", "chemical/fate").}

\item{method}{The HTTP method to use: "POST" (default for bulk searches) or "GET".}

\item{server}{Either a Global environment variable name (e.g., 'ctx_burl') or a direct URL string.}

\item{batch_limit}{The number of items to send per request. Bulk POSTs usually use 100-1000.
If set to 1, GET requests will append the query item directly to the URL path.
If set to 0, treats as static endpoint (no query appending).}

\item{auth}{Boolean; whether to include the API key header. Defaults to TRUE.}

\item{tidy}{Boolean; whether to convert the result to a tidy tibble. Defaults to TRUE.
If FALSE, returns a cleaned list structure.}

\item{path_params}{Optional vector or list of additional path parameters to append to the endpoint URL.
Used for endpoints with multiple path parameters (e.g., property range searches).
These are appended after the primary query parameter in the order provided.
Cannot be used with batching (batch_limit > 1).}

\item{content_type}{Expected response content type. Defaults to "application/json".
Supported types:
- "application/json": Parses response as JSON (default behavior)
- "text/plain": Returns response as character string
- "image/*" (e.g., "image/png", "image/svg+xml"): Returns raw bytes or magick image}

\item{...}{Additional parameters:
- If method is "POST": Added as query parameters to the URL.
- If method is "GET" and batch_limit is 1: Named arguments are added as query parameters.
- If method is "GET" and batch_limit > 1: Added as query parameters to the URL.}
}
\value{
Depends on content_type:
- JSON: A tidy tibble (if tidy=TRUE) or a cleaned list (if tidy=FALSE).
- text/plain: A character string.
- image/*: Raw bytes, or a magick image object if the magick package is available.
If no results are found, returns an empty tibble, empty list, or NULL.
}
\description{
This is a centralized template function used by nearly all \verb{ct_*} functions
to perform API requests. it handles normalization, batching, authentication,
error handling, and data tidying.
}
